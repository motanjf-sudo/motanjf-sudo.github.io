<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
  import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDybhWHcf85KDoBYdFWYIPCH0df3oKy7vU",
    authDomain: "nova-chat-408a2.firebaseapp.com",
    databaseURL: "https://nova-chat-408a2-default-rtdb.firebaseio.com",
    projectId: "nova-chat-408a2",
    storageBucket: "nova-chat-408a2.firebasestorage.app",
    messagingSenderId: "481208222196",
    appId: "1:481208222196:web:40a1c47adb6dd3ec77f9a1"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const messagesRef = ref(db, "messages");

  const input = document.getElementById("input");
  const messages = document.getElementById("messages");

  function send() {
    if (!input.value.trim()) return;
    push(messagesRef, { text: input.value });
    input.value = "";
  }

  window.send = send;

  input.addEventListener("keydown", e => {
    if (e.key === "Enter") send();
  });

  onChildAdded(messagesRef, snap => {
    const div = document.createElement("div");
    div.className = "msg";
    div.innerText = snap.val().text;
    messages.appendChild(div);
    messages.scrollTop = messages.scrollHeight;
  });
</script>
